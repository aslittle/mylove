<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ğŸ’– æˆ‘ä»¬çš„ç›¸å†Œ ğŸ’–</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bubblegum+Sans&family=Comic+Neue:wght@400;700&family=Caveat:wght@400;700&family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bgMusic" loop autoplay>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
    </audio>
    
    <!-- éŸ³æ•ˆ -->
    <audio id="clickSound">
        <source src="https://www.soundjay.com/buttons/sounds/button-09.mp3" type="audio/mpeg">
    </audio>
    <audio id="popSound">
        <source src="https://www.soundjay.com/buttons/sounds/button-14.mp3" type="audio/mpeg">
    </audio>
    
    <!-- é¡µé¢åŠ è½½åŠ¨ç”» -->
    <div id="loader">
        <div class="loader-content">
            <div class="heart"></div>
            <p>åŠ è½½ä¸­...</p>
        </div>
    </div>

    <!-- å¯¼èˆªèœå• -->
    <nav class="main-nav">
        <div class="container">
            <div class="nav-header">
                <h1 class="nav-title">ğŸ“¸ ä¹–ä¹–çš„ç›¸å†Œ</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">ğŸ  é¦–é¡µ</a></li>
                <li><a href="album.html" class="nav-link active">ğŸ“¸ ä¹–ä¹–çš„ç›¸å†Œ</a></li>
                <li><a href="story.html" class="nav-link">ğŸ“– æˆ‘ä»¬çš„æ•…äº‹</a></li>
                <li><a href="gifts.html" class="nav-link">ğŸ’Œ ä¸“å±æƒ…ä¹¦</a></li>
            </ul>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div id="mainContent" style="display: none;" class="content">
        <!-- é¡¶éƒ¨æ§åˆ¶æ  -->
        <div class="top-controls">
            <div class="container">
                <div class="controls">
                    <button id="musicToggle" class="control-btn">
                        <i class="fas fa-volume-up"></i>
                    </button>
                    <button id="soundToggle" class="control-btn">
                        <i class="fas fa-music"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- è£…é¥°å…ƒç´  -->
        <div id="decorations" class="decorations">
            <!-- è´è¶ -->
            <div class="decoration butterfly butterfly-1">ğŸ¦‹</div>
            <div class="decoration butterfly butterfly-2">ğŸ¦‹</div>
            <div class="decoration butterfly butterfly-3">ğŸ¦‹</div>
            <div class="decoration butterfly butterfly-4">ğŸ¦‹</div>
            
            <!-- æ˜Ÿæ˜Ÿ -->
            <div class="decoration star star-1">â­</div>
            <div class="decoration star star-2">â­</div>
            <div class="decoration star star-3">â­</div>
            <div class="decoration star star-4">â­</div>
            <div class="decoration star star-5">â­</div>
        </div>
        
        <!-- æ°”çƒ -->
        <div class="balloons">
            <div class="balloon balloon-1">ğŸˆ</div>
            <div class="balloon balloon-2">ğŸˆ</div>
            <div class="balloon balloon-3">ğŸˆ</div>
            <div class="balloon balloon-4">ğŸˆ</div>
            <div class="balloon balloon-5">ğŸˆ</div>
        </div>
        
        <!-- ç›¸å†Œå¤´éƒ¨ -->
        <header id="albumHeader" class="header">
            <div class="container">
                <h1 class="header-title">ğŸ’– æˆ‘ä»¬çš„ç¾å¥½å›å¿† ğŸ’–</h1>
                <p class="header-subtitle">æ¯ä¸€å¼ ç…§ç‰‡éƒ½è®°å½•ç€æˆ‘ä»¬çš„å¹¸ç¦æ—¶å…‰</p>
            </div>
        </header>

        <!-- ç›¸å†Œå±•ç¤ºåŒºåŸŸ -->
        <section id="albumGallery" class="section">
            <div class="container">
                <div class="gallery album-gallery">
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1580489944761-15a19d654956?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1567529837169-97a204c231e4?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1582791698869-0c0a54315c63?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1518611012118-696072aa579a?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1522075469751-3a6694fb2f61?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1517486808906-6ca8b3f04846?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                    <div class="gallery-item" data-img="https://images.unsplash.com/photo-1504253163759-2f6a4303b3f6?w=300&h=300&fit=crop">   
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç›¸å†Œè¯´æ˜åŒºåŸŸ -->
        <section id="albumNotes" class="section">
            <div class="container">
                <div class="letter-container">
                    <div class="letter">
                        <div class="letter-header">
                            <h3>ğŸ’Œ ç›¸å†Œæ„Ÿè¨€</h3>
                        </div>
                        <div class="letter-content">
                            <p>äº²çˆ±çš„ä¹–ä¹–ï¼Œ</p>
                            <p>è¿™äº›ç…§ç‰‡è®°å½•äº†ä½ æœ€ç¾çš„ç¬é—´ï¼Œæ¯ä¸€å¼ éƒ½è®©æˆ‘å¿ƒåŠ¨ä¸å·²ã€‚</p>
                            <p>ä½ çš„ç¬‘å®¹ã€ä½ çš„çœ¼ç¥ã€ä½ çš„æ¯ä¸€ä¸ªè¡¨æƒ…ï¼Œéƒ½æ˜¯é‚£ä¹ˆç¾ä¸½åŠ¨äººã€‚</p>
                            <p>æ„Ÿè°¢ä¸Šå¤©è®©æˆ‘é‡åˆ°è¿™ä¹ˆå®Œç¾çš„ä½ ï¼Œæˆ‘ä¼šæ°¸è¿œçæƒœä½ ã€çˆ±æŠ¤ä½ ã€‚</p>
                            <p>æˆ‘çˆ±ä½ ï¼Œæ°¸è¿œæ°¸è¿œï¼</p>
                            <p class="signature">çˆ±ä½ çš„è½</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- è®¸æ„¿äº’åŠ¨åŒºåŸŸ -->
        <section id="wishInteractive" class="section">
            <div class="container">
                <h2 class="section-title">âœ¨ è®¸ä¸‹ä½ çš„æ„¿æœ› âœ¨</h2>
                <div class="wish-container">
                    <div class="wish-input-area">
                        <textarea id="wishInput" placeholder="ä¹–ä¹–ï¼Œåœ¨è¿™é‡Œå†™ä¸‹ä½ çš„æ„¿æœ›..." maxlength="100"></textarea>
                        <button id="wishSubmit" class="wish-btn">
                            <i class="fas fa-star"></i> å‘é€æ„¿æœ›
                        </button>
                        <div id="wishCount" class="wish-count">0/100</div>
                    </div>
                    <div id="wishDisplay" class="wish-display">
                        <div class="wish-message" id="wishMessage"></div>
                        <div id="wishStars" class="wish-stars"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç…§ç‰‡ä¸Šä¼ åŒºåŸŸ -->
        <section id="photoUpload" class="section">
            <div class="container">
                <h2 class="section-title">ğŸ“· ä¸Šä¼ æ–°ç…§ç‰‡ ğŸ“·</h2>
                <div class="upload-form-container">
                    <form id="photoUploadForm" class="upload-form">
                        <div class="form-group">
                            <label for="photoTitle">ç…§ç‰‡æ ‡é¢˜</label>
                            <input type="text" id="photoTitle" name="photoTitle" placeholder="ç»™ç…§ç‰‡èµ·ä¸ªå¥½å¬çš„åå­—..." required>
                        </div>
                        <div class="form-group">
                            <label for="photoFile">é€‰æ‹©ç…§ç‰‡</label>
                            <label for="photoFile" class="file-upload-label">
                                <i class="fas fa-image"></i> é€‰æ‹©ç…§ç‰‡æ–‡ä»¶
                            </label>
                            <input type="file" id="photoFile" name="photoFile" accept="image/*" required>
                        </div>
                        <div class="form-group">
                            <label for="photoDescription">ç…§ç‰‡æè¿°</label>
                            <textarea id="photoDescription" name="photoDescription" placeholder="å†™ä¸‹å…³äºè¿™å¼ ç…§ç‰‡çš„æ•…äº‹..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="upload-btn">
                                <i class="fas fa-upload"></i> ä¸Šä¼ ç…§ç‰‡
                            </button>
                        </div>
                    </form>
                    <div id="photoPreview" class="photo-preview">
                        <img id="previewImage" src="" alt="ç…§ç‰‡é¢„è§ˆ">
                    </div>
                </div>
            </div>
        </section>

        <!-- åº•éƒ¨ -->
        <footer>
            <div class="container">
                <p>ğŸ’ çˆ±ä½ çš„æ¯ä¸€å¤© ğŸ’</p>
            </div>
        </footer>
    </div>

    <!-- å›¾ç‰‡æŸ¥çœ‹å™¨ -->
    <div id="imageViewer" class="image-viewer">
        <span class="close">&times;</span>
        <img class="viewer-content" id="viewerImage">
        <div class="caption-container">
            <p id="caption"></p>
        </div>
    </div>

    <!-- é›ªèŠ±æ•ˆæœ -->
    <div id="snowflakes"></div>

    <script src="js/script.js"></script>
    <script>
        // ç…§ç‰‡ä¸Šä¼ åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            const photoFileInput = document.getElementById('photoFile');
            const previewImage = document.getElementById('previewImage');
            const photoPreview = document.getElementById('photoPreview');
            const photoUploadForm = document.getElementById('photoUploadForm');

            // ç¡®ä¿æ‰€æœ‰å¿…è¦çš„å…ƒç´ éƒ½å­˜åœ¨
            if (!photoFileInput || !previewImage || !photoPreview || !photoUploadForm) {
                return;
            }

            // ç…§ç‰‡é¢„è§ˆ
            photoFileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        if (previewImage) {
                            previewImage.src = e.target.result;
                        }
                        if (photoPreview) {
                            photoPreview.classList.add('show');
                        }
                    };
                    reader.readAsDataURL(file);
                } else {
                    if (photoPreview) {
                        photoPreview.classList.remove('show');
                    }
                }
            });

            // è¡¨å•æäº¤
            photoUploadForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const photoTitleInput = document.getElementById('photoTitle');
                const photoDescriptionInput = document.getElementById('photoDescription');
                
                if (!photoTitleInput || !photoDescriptionInput) {
                    return;
                }
                
                const photoTitle = photoTitleInput.value.trim();
                const photoDescription = photoDescriptionInput.value.trim();
                const photoFile = photoFileInput.files[0];

                if (!photoTitle || !photoFile) {
                    alert('è¯·å¡«å†™ç…§ç‰‡æ ‡é¢˜å¹¶é€‰æ‹©ç…§ç‰‡ï¼');
                    return;
                }

                const reader = new FileReader();

                reader.onload = function(e) {
                    const photoData = {
                        id: Date.now(),
                        title: photoTitle,
                        description: photoDescription,
                        image: e.target.result,
                        timestamp: new Date().toISOString()
                    };

                    // ä¿å­˜åˆ°localStorage
                    saveToLocalStorage('happyPhotos', photoData);
                    
                    // æ¸…ç©ºè¡¨å•
                    photoUploadForm.reset();
                    if (photoPreview) {
                        photoPreview.classList.remove('show');
                    }
                    
                    // åˆ·æ–°ç›¸å†Œæ˜¾ç¤º
                    loadPhotos();
                    
                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showSuccessMessage('ç…§ç‰‡ä¸Šä¼ æˆåŠŸï¼');
                };

                reader.readAsDataURL(photoFile);
            });

            // ä¿å­˜åˆ°localStorage
            function saveToLocalStorage(key, data) {
                try {
                    const savedData = JSON.parse(localStorage.getItem(key) || '[]');
                    savedData.push(data);
                    localStorage.setItem(key, JSON.stringify(savedData));
                } catch (error) {
                    console.error('ä¿å­˜å¤±è´¥:', error);
                    alert('ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼');
                }
            }

            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            function showSuccessMessage(message) {
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                successDiv.textContent = message;
                document.body.appendChild(successDiv);
                
                // 3ç§’åç§»é™¤
                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
            }

            // åŠ è½½ç…§ç‰‡åˆ°ç›¸å†Œ
            function loadPhotos() {
                const gallery = document.querySelector('.gallery.album-gallery');
                if (!gallery) {
                    return;
                }
                
                const savedPhotos = JSON.parse(localStorage.getItem('happyPhotos') || '[]');
                
                // æ¸…ç©ºç°æœ‰ç…§ç‰‡
                gallery.innerHTML = '';
                
                // æ˜¾ç¤ºé»˜è®¤ç…§ç‰‡
                const defaultPhotos = [
                    "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1580489944761-15a19d654956?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1567529837169-97a204c231e4?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1582791698869-0c0a54315c63?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1518611012118-696072aa579a?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1522075469751-3a6694fb2f61?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1517486808906-6ca8b3f04846?w=300&h=300&fit=crop",
                    "https://images.unsplash.com/photo-1504253163759-2f6a4303b3f6?w=300&h=300&fit=crop"
                ];
                
                // æ˜¾ç¤ºé»˜è®¤ç…§ç‰‡
                defaultPhotos.forEach((imgSrc, index) => {
                    const galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';
                    galleryItem.setAttribute('data-img', imgSrc);
                    galleryItem.innerHTML = `
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    `;
                    gallery.appendChild(galleryItem);
                });
                
                // æ·»åŠ ç”¨æˆ·ä¸Šä¼ çš„ç…§ç‰‡
                savedPhotos.forEach(photo => {
                    const galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';
                    galleryItem.setAttribute('data-img', photo.image);
                    galleryItem.setAttribute('data-title', photo.title);
                    galleryItem.setAttribute('data-description', photo.description);
                    galleryItem.innerHTML = `
                        <div class="gallery-overlay">
                            <i class="fas fa-heart"></i>
                        </div>
                    `;
                    gallery.appendChild(galleryItem);
                });
            }

            // åˆå§‹åŠ è½½ç…§ç‰‡
            loadPhotos();
        });
    </script>
</body>
</html>
